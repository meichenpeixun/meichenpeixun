/*! LPS4.0 2016-08-29
*/
function Tips(e,a){e.wrap('<div class="tips-box"></div>').after('<span class="tips">'+a+"</span>"),setTimeout(function(){e.unwrap().siblings().remove(".tips"),e.focus()},4e3)}function login_popup(){$("#id_account_l").val(""),$("#id_password_l").val(""),$("#id_email").val(""),$("#id_password").val(""),$("#id_captcha_1").val(""),$("#id_mobile").val(""),$("#id_mobile_code").val(""),$("#id_password_m").val(""),$("#id_captcha_m_1").val(""),$("#id_captcha_1").val(""),$("#login-form-tips").hide(),$("#findpassword-tips").hide(),$("#mobile_code_password-tips").hide(),$("#register-tips").hide(),$("#loginModal").modal("show")}function zy_Countdown(){zy_c_num--,$(".sendE2 span").html(zy_c_num+"s"),$(".zy_success span").html(zy_str),58>zy_c_num&&$(".zy_success").addClass("upmove"),0>=zy_c_num&&(zy_c_num=60,$(".sendE2").hide(),$(".sendE").show(),clearInterval(sendECount))}function login_form_submit(){$.ajax({cache:!1,type:"POST",url:"/user/login/",data:$("#login_form").serialize(),beforeSend:function(){$("#login_btn").html("登录中..."),$("#login_btn").attr("disabled","disabled")},success:function(e){if(e.account_l)$("#login-form-tips").html(e.account_l).show(500),$("#id_account_l").focus();else if(e.password_l)$("#login-form-tips").html(e.password_l).show(500),$("#id_password_l").focus();else{if("success"==e.status)return"True"==e.onepay_status?window.location.replace("/"):window.location.replace(e.url),detect_ie()!==!1&&window.location.reload(),void 0;"failure"==e.status&&("no_active"==e.msg?(zyemail=$("#id_account_l").val(),zyUname=zyemail,zy_validate_Email(!1,zyemail,$("#id_password_l").val())):$("#login-form-tips").html("账号或者密码错误，请重新输入").show(500))}},complete:function(){$("#login_btn").html("登录"),$("#login_btn").removeAttr("disabled")}})}function show_send_sms(e){return $("#forgetpswMobileModal .send-verify,#verify_form .send-verify").html("重发验证码（"+e+"s）").css({background:"#D6D6D6"}).attr("disabled","disabled"),0>=e?($(".verify-tips.success").hide(500),$("#forgetpswMobileModal .send-verify,#verify_form .send-verify").html("重发验证码").css({background:"#5ECFBA"}).removeAttr("disabled"),sendOFF=!0,void 0):(e--,setTimeout("show_send_sms("+e+")",1e3),void 0)}function send_sms_code(){show_send_sms(60);var e=$("#id_mobile_code").val(),a="";(""==e||void 0==e)&&(e=$("#id_mobile_f").val(),a="change"),sendOFF&&($.ajax({cache:!1,type:"POST",url:"/user/register/mobile/sendsms_signup/",data:{mobile:e,geetest_challenge:$(".geetest_challenge").attr("value"),geetest_validate:$(".geetest_validate").attr("value"),geetest_seccode:$(".geetest_seccode").attr("value"),way:a},success:function(e){e.mobile?""!=a?$("#mobile_code_password_form_message").css({background:"#f2dede"}).html(e.mobile):$(".verify-tips").removeClass("success").addClass("error").html(e.mobile).show(500):e.captcha?""!=a?$("#mobile_code_password_form_message").css({background:"#f2dede"}).html(e.captcha):$(".verify-tips").removeClass("success").addClass("error").html(e.captcha).show(500):"success"==e.status?""!=a?$("#mobile_code_password_form_message").css({background:"#f2dede"}).html(""):($(".verify-tips").removeClass("error").addClass("success").html(e.info).show(500),show_send_sms(60)):"failure"==e.status&&(""!=a?$("#mobile_code_password_form_message").css({background:"#f2dede"}).html("请稍后再试"):$(".verify-tips").removeClass("success").addClass("error").html("短信验证码发送失败").show(500))},complete:function(){$("#send-verify").html("重发验证码"),$("#send-verify").removeAttr("disabled")}}),sendOFF=!1)}function zy_validate_Email(e,a){var s=!0;if(e)s=!0;else{$("#emailValidate .close").unbind().click(function(){$("#emailValidate").modal("hide")}),$("#registerModal").modal("hide"),$("#addemailModal").modal("hide"),$("#emailValidate").modal("show");var t=$(".zy_email .a>a"),o=a.split("@")[1];t.attr("href",hash[o]),$("#emailValidateEE span").html(a),(void 0==hash[o]||null==hash[o])&&t.parent().hide(),s=!1}return s}function mobile_code_password_form_submit(){$.ajax({cache:!1,type:"POST",url:"/user/password/find/mobile/",data:$("#mobile_code_password_form").serialize(),beforeSend:function(){$("#mobile_code_password_btn").html("提交中..."),$("#mobile_code_password_btn").attr("disabled","disabled")},success:function(e){e.mobile_code_f?($("#mobile_code_password-tips").html(e.mobile_code_f).show(500),$("#id_mobile_code_f").focus()):"success"==e.status&&(account=$("#id_account").val(),code=$("#id_mobile_code_f").val(),location.href="/user/password/reset/"+account+"/"+code)},complete:function(){$("#mobile_code_password_btn").html("提交"),$("#mobile_code_password_btn").removeAttr("disabled")}})}function flayer_show(){$("#fLayerdl").show(),$("#dd_listbox").hide()}function flayer_hide(e){e?setTimeout("$('#fLayerdl').hide();",e):$("#fLayerdl").hide()}function listbox_show(){$("#dd_listbox").show(),$("#fLayerdl").hide()}function listbox_hide(e){e?setTimeout("$('#dd_listbox').hide();",e):$("#dd_listbox").hide()}function searchajax(e){$.ajax({url:"http://suggest.maiziedu.com/suggest/?keyword="+e,type:"GET",dataType:"jsonp",jsonp:"callback",success:function(e){var a=[],s=[],t=[],o=[],i=[];if($.each(e,function(e,c){$.each(c.courses,function(e,l){a.push({id:l.id,name:c.name,student_count:l.student_count}),$.each(l.careers,function(e,a){a.student_count&&(-1==i.indexOf(a.name)&&(s.push({name:a.name,short_name:a.short_name,image:a.image,description:a.description,student_count:a.student_count}),i.push(a.name)),$.each(a.teachers,function(e,a){-1==o.indexOf(a.name)&&(t.push({teacher_id:a.teacher_id,name:a.name,title:a.title,image:a.image,info:a.info}),o.push(a.name))}))})})}),0==a.length)return $(".dd_listbox").hide(),void 0;var c="";$(".careercraft").remove(),$.each(a,function(e,a){c='<div class="careercraft"><a target="_blank" href="/course/'+a.id+'/"><p class="pull-left course_info">'+a.name+'</p><p class="pull-right study_count">'+a.student_count+"人正在学习</p></a></div>",$("#course_name_ledg").append(c)}),$(".chcourse").remove(),$.each(s,function(e,a){c='<div class="chcourse"><img src="/uploads/'+a.image+'" class="dd_courseimg img-circle"><a target="_blank" href="/course/'+a.short_name+'-px/" style="outline:none;"><p class="dd_coursedescriname">'+a.name+'</p><p class="radius"><span class="f_radius">毕业学员： <span class="finished_count">'+a.student_count+'</span>人</span></p><p class="dd_coursedescri">'+a.description+"</p>",$("#incld_careers").append(c)}),$(".careerteacher").remove(),$.each(t,function(e,a){c='<div class="careerteacher"><a target="_blank" href="/u/'+a.teacher_id+'/" style="outline:none;"><img src="/uploads/'+a.image+'" class="dd_courseimg img-circle"><p class="courseteacher">'+a.name+'</p><p class="ls">|</p><p class="teachertt">'+a.title+'</p><p class="teacherdes">'+a.info+"</p></a></div>",$("#incld_teachers").append(c)}),$("#data-search").val()&&(0==s.length?($("#dd_csitem").hide(),$("#incld_careers").hide()):($("#dd_csitem").show(),$("#incld_careers").show()),0==t.length?($("#dd_tutor").hide(),$("#incld_teachers").hide()):($("#dd_tutor").show(),$("#incld_teachers").show()),0==a.length?($("#dd_craft").hide(),$("#course_name_ledg").hide()):($("#dd_craft").show(),$("#course_name_ledg").show()),listbox_show())}})}function Search(){function e(e){var e=e.replace("#","u0023").replace("?","u0022");if($(".search_result_bg").length>0){var a=$(".search_app").val()?$(".search_app").val():"course";window.location.href="/search/"+a+"/"+e+"-1/"}else window.open("/search/course/"+e+"-1/")}$(".search-btn").click(function(){e($("#data-search").val()),zhuge.track("搜索次数",{"搜索关键词":$("#data-search").val()})}),$("#data-search").keyup(function(a){var s=a||window.event||arguments.callee.caller.arguments[0];return s&&13==s.keyCode?(e($(this).val()),void 0):void 0})}function cutTimer(e,a){window.setInterval(function(){var s=0,t=0,o=0,i=0;e>0&&(s=Math.floor(e/86400),t=Math.floor(e/3600)-24*s,o=Math.floor(e/60)-60*24*s-60*t,i=Math.floor(e)-60*60*24*s-60*60*t-60*o),9>=o&&(o="0"+o),9>=i&&(i="0"+i),$(a+"#day_show").html(s+"天"),$(a+"#hour_show").html(t+"时"),$(a+"#minute_show").html(o+"分"),$(a+"#second_show").html(i+"秒"),e--},1e3)}function tab(e){var a={tabNav:".tab_menu > li",tabBox:".tab_box > div",select:"active",type:"show"},s=e;$.extend(a,e);var t=$(a.tabNav||s.tabNav);t.click(function(){$(this).addClass(a.select||s.select).siblings().removeClass(a.select||s.select);var e=t.index(this);switch(a.type){case"show":$(a.tabBox||s.tabBox).eq(e).show().siblings().hide();break;case"slide":$(a.tabBox||s.tabBox).eq(e).slideDown(300).siblings().slideUp(300);break;case"fade":$(a.tabBox||s.tabBox).eq(e).fadeIn(300).siblings().fadeOut(300)}})}$(".class53").click(function(){$("#KFLOGO .Lelem").eq(0).trigger("click")}),$(".toolbar-item-weibo>div").hover(function(){},function(){$(this).stop().hide("fast")}),$(".toolbar-item-weibo").click(function(){$(".lixianB").show()}),$(".toolbar-item-weixin").unbind().click(function(){$("#KFLOGO .Lelem").eq(0).trigger("click")}),$(".toolbar-item-gotop").click(function(){$("html,body").stop().animate({scrollTop:"0px"},800)}),$(".globalLoginBtn").on("click",login_popup),$(".globalLogin").on("click",function(){login_form_submit("login-form-tips")}),function(){var e=[];$(".modal").on("show.bs.modal",function(){for(var a=0;e.length>a;a++)e[a]&&(e[a].modal("hide"),e[a]=null);e.push($(this));var s=$(this),t=s.find(".modal-dialog"),o=$('<div style="display:table; width:100%; height:100%;"></div>');o.html('<div style="vertical-align:middle; display:table-cell;"></div>'),o.children("div").html(t),s.html(o)})}();var zy_c_num=60,zy_str="",sendECount;$(".sendE a").click(function(){sendECount=setInterval(zy_Countdown,1e3),$(".zy_success").removeClass("upmove"),$(this).parent().hide(),$(".sendE2").show().find("span").html("60s"),$.ajax({type:"GET",url:"/user/send_again_email",data:{username:$("#id_account_l").val()},dataType:"html",success:function(e){zy_str="验证邮件发送成功",e&&zy_Countdown()},error:function(){zy_str="验证邮件发送失败"}})});var sendOFF=!0,OFF=!0;$("#btnForgetpsw").on("click",function(){captchaObjF3&&captchaObjF3.refresh(),OFF&&(captcha(".newcaptcha"),OFF=!1),$("#forgetpswModal").modal("show"),$("#loginModal").modal("hide")}),$("#forgetpswMobileModal .send-verify").click(function(){send_sms_code("verify_form","verify-tips")}),$("#mobile_code_password_btn").click(mobile_code_password_form_submit);var zyemail="",zyUname="",hash={"qq.com":"http://mail.qq.com","gmail.com":"http://mail.google.com","sina.com":"http://mail.sina.com.cn","163.com":"http://mail.163.com","126.com":"http://mail.126.com","yeah.net":"http://www.yeah.net/","sohu.com":"http://mail.sohu.com/","tom.com":"http://mail.tom.com/","sogou.com":"http://mail.sogou.com/","139.com":"http://mail.10086.cn/","hotmail.com":"http://www.hotmail.com","live.com":"http://login.live.com/","live.cn":"http://login.live.cn/","live.com.cn":"http://login.live.com.cn","189.com":"http://webmail16.189.cn/webmail/","yahoo.com.cn":"http://mail.cn.yahoo.com/","yahoo.cn":"http://mail.cn.yahoo.com/","eyou.com":"http://www.eyou.com/","21cn.com":"http://mail.21cn.com/","188.com":"http://www.188.com/","foxmail.coom":"http://www.foxmail.com"};Search(),$(document).ready(function(){$("#data-search").focus(function(){keywd=$("#data-search").val(),""==keywd?flayer_show():searchajax(keywd)}).blur(function(){flayer_hide(500)}),$("#data-search").keyup(function(){return keywd=$("#data-search").val(),""==keywd?(listbox_hide(),flayer_show(),void 0):(searchajax(keywd),void 0)}).blur(function(){return keywd=$("#data-search").val(),""==keywd?(listbox_hide(),void 0):(listbox_hide(500),void 0)})});